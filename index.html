<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Chama Prototype</title>
</head>
<body>
<h2>Prototype Chama System</h2>

<h3>Register</h3>
<input id="regEmail" placeholder="Email">
<input id="regPassword" placeholder="Password">
<select id="role">
  <option value="admin">Admin</option>
  <option value="member">Member</option>
</select>
<button onclick="register()">Register</button>

<h3>Login</h3>
<input id="loginEmail" placeholder="Email">
<input id="loginPassword" placeholder="Password">
<button onclick="login()">Login</button>

<script>
const API = "/exec";

function register(){
  const email=document.getElementById("regEmail").value;
  const password=document.getElementById("regPassword").value;
  const role=document.getElementById("role").value;

  fetch(API,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ sheet:"Users", action:"register", email, password, role })
  })
  .then(r=>r.json())
  .then(d=>alert(d.success ? "Registered! Login now." : d.message))
  .catch(e=>alert("Error: "+e.message));
}

function login(){
  const email=document.getElementById("loginEmail").value;
  const password=document.getElementById("loginPassword").value;

  fetch(API,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ sheet:"Users", action:"login", email, password })
  })
  .then(r=>r.json())
  .then(d=>{
    if(d.success){
      localStorage.setItem("user", JSON.stringify(d.user));
      window.location.href="dashboard.html";
    } else alert(d.message);
  })
  .catch(e=>alert("Error: "+e.message));
}
</script>
</body>
</html>
